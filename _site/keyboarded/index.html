<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--><!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8"><![endif]--><!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9"><![endif]--><!--[if gt IE 8]><!--><html class="no-js">
<!--<![endif]--> <head> <meta charset="UTF-8"> <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"> <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> <title>关于Keyboard Extension – DSL'Blog</title> <meta name="description" content="我叫董诗磊,我就是一码农.欢迎来到我的博客"> <meta name="keywords" content=""> <!-- Twitter Cards --> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="/assets/img/logo.png"> <meta name="twitter:title" content="关于Keyboard Extension"> <meta name="twitter:description" content="关于Keyboard Extension"> <!-- Open Graph --> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="关于Keyboard Extension"> <meta property="og:description" content="关于Keyboard Extension"> <meta property="og:url" content="/keyboarded/"> <meta property="og:site_name" content="DSL'Blog"> <meta property="og:image" content="/assets/img/logo.png"> <link rel="canonical" href="/keyboarded/"> <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="DSL'Blog Feed"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- CSS --> <link rel="stylesheet" href="/assets/css/main.css"> <!-- JS --> <script src="/assets/js/modernizr-3.3.1.custom.min.js"></script> <!-- Favicons --> <link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"> <link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"> <link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"> <link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"> <link rel="shortcut icon" type="image/png" href="/favicon.png"> <link rel="shortcut icon" href="/favicon.ico"> <!-- Background Image --> <style type="text/css">body {background-image:url(/assets/img/placeholder-big.jpg); background-repeat: no-repeat; background-size: cover; }</style> <!-- Post Feature Image --> </head> <body> <nav id="dl-menu" class="dl-menuwrapper" role="navigation"> <button class="dl-trigger">Open Menu</button> <ul class="dl-menu"> <li><a href="/">Home</a></li> <li> <a href="#">About</a> <ul class="dl-submenu"> <li> <img src="/assets/img/logo.png" alt="DSL'Blog photo" class="author-photo"> <h4>DSL'Blog</h4> <p>我叫董诗磊,我就是一码农.欢迎来到我的博客</p> </li> <li><a href="/about/"><span class="btn btn-inverse">Learn More</span></a></li> <li> <a href="mailto:945846242@qq.com" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-envelope-square"></i> Email</a> </li> <li> <a href="http://github.com//dslcoding" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-github"></i> Github</a> </li> </ul>
<!-- /.dl-submenu --> </li> <li> <a href="#">Posts</a> <ul class="dl-submenu"> <li><a href="/posts/">All Posts</a></li> <li><a href="/tags/">All Tags</a></li> </ul> </li> <li><a href="/projects/">Projects</a></li> </ul>
<!-- /.dl-menu --> </nav><!-- /.dl-menuwrapper --> <!-- Header --> <header class="header" role="banner"> <div class="wrapper animated fadeIn"> <div class="content"> <div class="post-title "> <h1>关于Keyboard Extension</h1> <h4>01 Apr 2017</h4> <p class="reading-time"> <i class="fa fa-clock-o"></i> Reading time ~1 minute </p>
<!-- /.entry-reading-time --> <a class="btn zoombtn" href="/posts/"> <i class="fa fa-chevron-left"></i> </a> </div> <h1 id="关于keyboard-extension">关于Keyboard Extension</h1> <hr> <p>写了好几天的keyboarded extension， 说实话这个Extension 有点恶心。我感觉bug挺多的，也不能这样说，可能不经常出现的bug都让我遇到了。下面开始说我遇到到了那些问题，以及是怎么做的。</p> <p>声明：本文章不做文档翻译，想看翻译自行查询.(网上的都是翻译不解决实际问题。我已经。。。。) <a href="http://www.jianshu.com/p/987dfa9f3baf">键盘扩展翻译</a></p> <h3 id="1-代码分享hostapp-与containapp代码分享和todayextortion-是一样的这里不做多说-todayextortion">1 代码分享。hostApp 与containApp代码分享和TodayExtortion 是一样的。这里不做多说 TodayExtortion</h3> <h3 id="2数据共享hostapp-与containapp代码分享和todayextortion-是一样的不做多说-todayextortion">2数据共享。hostApp 与containApp代码分享和TodayExtortion 是一样的。不做多说 TodayExtortion</h3> <h3 id="3申请idhostapp-与containapp代码分享和todayextortion-是一样的不做多说todayextortion">3申请ID。hostApp 与containApp代码分享和TodayExtortion 是一样的。不做多说TodayExtortion</h3> <p>以上都是共同点，毕竟都是扩展。</p> <p>下面我认为是重点(因为我是吃过亏的)：</p> <h3 id="1关于在扩展中使用cocoapods这个会者不难难者恶心">1.关于在扩展中使用cocoapods，这个会者不难，难者恶心。</h3> <p>首先先看stackoverflow<a href="http://stackoverflow.com/questions/37280077/error-with-cocoapods-link-with-after-update-to-1-0-0">Extension cocoapods</a>这个是我在扩展中使用cocoapads出现问题在stackoverflow中找到的目前我找的最佳答案。如果谁知道更好的方法，给我也说说。按照这个上面的说的直接就可以用在hostApp与containApp分别导入相应库就可以了。 <img src="http://ac-l1vX02tC.clouddn.com/5adbe79572ebbc69b073.png" alt=""> 主意：提示框如果要是使用第三方的话 ，(算了还是别用第三放了，因为第三方的有sharedApplication，在扩展中获取不到sharedApplication对象)，一定主意。当你按照上面的内容 pod install 成功的时候，你会发现在项目中的hostApp 与containApp中使用的一些库的头文件报错，意思是找不到相应的文件，遇到这种情况，别着急。因为不添加这个use_frameworks!，cocoapads是用static libraries 管理代码的，如果是使的话，cocoapads则是用framework的形式管理代码。所以你必须分别到hostApp 与containApp 中的Target中的BuildPhases 中的 Linked Framework and Libraries 添加相应的第三库，运行一下，顺利通过。这个cocoapds就到此为止。</p> <h3 id="2关于键盘的高度">2.关于键盘的高度</h3> <p>我测试过，讯飞的键盘的高度大概在280左右。于是我也是280.但是我发现一个问题。我的手机是iOS9，但是按照官方文档的自定义高度的方法，不起作用，我在iOS10就可以。于是我🈶️去stackoverflow转了一下，找到了这个。就顺利解决了<a href="http://stackoverflow.com/questions/36145450/incorrect-keyboard-extension-height-after-rotation">自定义键盘高度</a>。我写在viewdidload里面。就是加载不出来。哎。。。</p> <h3 id="3切换输入法">3.切换输入法</h3> <p>官方文档明确表示，没有给用户切换下个输入法的第三方键盘是不会过审核的。大家主意安全。我一开始就用的是这个方法，</p>
<pre><code class="language-Objective-C">- (void)handleInputModeListFromView:(nonnull UIView *)view withEvent:(nonnull UIEvent *)event NS_AVAILABLE_IOS(10_0);
</code></pre>
<p>在iOS10上面用的挺爽的。到iOS9上怎么测试就是行。后来看看那个只是针对iOS10 的，尴尬。用这个</p>
<pre><code class="language-Objective-C"> //iOS9 和iOS10都是可以的。可以试试
  - (void)advanceToNextInputMode;
</code></pre>
<h3 id="4推荐一些第三方的">4.推荐一些第三方的。</h3> <p>keyboard <a href="https://github.com/polishedcode/tasty-imitation-keyboard">Extension第三方</a>。这个自定义键盘其实也不太难。他是一个控制器 UIInputViewController继承自UIViewController，说白就是一个控制器，除了不能获取sharedApplication对象，别的还可以。还有就是坐标的问题，要主意一下。每个人都有获取坐标的习惯不一样，比如我是这样的self.view.frame.size.with。这个在扩展中是不能获取到的。主意。</p> <h3 id="5记得把requestsopenaccess设置为yes">5.记得把RequestsOpenAccess设置为YES。</h3> <h3 id="6至今未解决的问题">6.至今未解决的问题。</h3> <p>请求帮助 我的需求是扩展键盘上放了一个uicollectview。每个cell上都加载一个图片。获取图片的步骤：从网络上请求，转化data在转成base64，生成base64字符串。存到数据库。显示的时候，将base64字符串转成data 在转成image；每个图片大概有1Mgif动图吧。不知掉哪个环节出现问题。以至于总是报如下的两个错误。(后来我用工具检测发现内存蹦了600M，用的SDWebimage加载的)。后来用了各种的方法解决也没解决成功就放弃了。</p> <h3 id="61遇见的插件中断和服务中断下面是服务中断的错误信息">6.1遇见的插件中断和服务中断。下面是服务中断的错误信息</h3> <p>2017-03-24 21:37:45.820834 ExpressionBaby[3672:934876] viewServiceDidTerminateWithError:: Error Domain=_UIViewServiceInterfaceErrorDomain Code=3 “(null)” UserInfo={Message=Service Connection Interrupted} 2017-03-24 21:37:48.709876 ExpressionBaby[3672:934876] [App] if we’re in the real pre-commit handler we can’t actually add any new fences due to CA restriction 2017-03-24 21:37:49.222492 ExpressionBaby[3672:934876] viewServiceDidTerminateWithError:: Error Domain=_UIViewServiceInterfaceErrorDomain Code=3 “(null)” UserInfo={Message=Service Connection Interrupted} 2017-03-24 21:37:51.231664 ExpressionBaby[3672:934876] viewServiceDidTerminateWithError:: Error Domain=_UIViewServiceInterfaceErrorDomain Code=3 “(null)” UserInfo={Message=Service Connection Interrupted} 2017-03-24 21:37:53.225378 ExpressionBaby[3672:934876] [App] if we’re in the real pre-commit handler we can’t actually add any new fences due to CA restriction 2017-03-24 21:37:54.500931 ExpressionBaby[3672:934876] [App] if we’re in the real pre-commit handler we can’t actually add any new fences due to CA restriction 2017-03-24 21:37:55.016598 ExpressionBaby[3672:934876] viewServiceDidTerminateWithError:: Error Domain=_UIViewServiceInterfaceErrorDomain Code=3 “(null)” UserInfo={Message=Service Connection Interrupted}</p> <h3 id="61-上架补充上架的时候一定要有数字和英文键盘另一个是协议必须要有的">6.1 上架补充，上架的时候一定要有数字和英文键盘,另一个是协议必须要有的，<img src="http://ac-l1vX02tC.clouddn.com/7b86d88e2a3da8847506.png" alt="">
</h3> <p>协议内容就是关于用户的隐私什么的,大概内容就是要保护用户的隐私.(必须要写的)</p> <p>我叫董诗磊我就是一码农。</p> <div class="entry-meta"> <br> <hr> <span class="entry-tags"></span> <span class="social-share"> <a href="https://www.facebook.com/sharer/sharer.php?u=/keyboarded/" title="Share on Facebook" class="tag"> <span class="term"><i class="fa fa-facebook-square"></i> Share</span> </a> <a href="https://twitter.com/intent/tweet?text=/keyboarded/" title="Share on Twitter" class="tag"> <span class="term"><i class="fa fa-twitter-square"></i> Tweet</span> </a> <a href="https://plus.google.com/share?url=/keyboarded/" title="Share on Google+" class="tag"> <span class="term"><i class="fa fa-google-plus-square"></i> +1</span> </a> </span> <div style="clear:both"></div> </div> </div> </div> </header> <!-- JS --> <script src="/assets/js/jquery-1.12.0.min.js"></script> <script src="/assets/js/jquery.dlmenu.min.js"></script> <script src="/assets/js/jquery.goup.min.js"></script> <script src="/assets/js/jquery.magnific-popup.min.js"></script> <script src="/assets/js/jquery.fitvid.min.js"></script> <script src="/assets/js/scripts.js"></script> <script type="text/javascript"> var disqus_shortname = 'taylantatli'; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); (function () { var s = document.createElement('script'); s.async = true; s.type = 'text/javascript'; s.src = '//' + disqus_shortname + '.disqus.com/count.js'; (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s); }()); </script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript> <!-- MathJax --> <script async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> </body> </html>
